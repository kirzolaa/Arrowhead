Loaded 361 eigenvector files. Shape: (361, 4, 4)
Loaded 361 eigenvalue files. Shape: (361, 4)

Tracking eigenstates by maximum overlap...
  Step 30, Eigenstate 0: Tracked to index 0 (Overlap: 1.000000)
  Step 30, Eigenstate 1: Tracked to index 2 (Overlap: 0.999947)
  Step 30, Eigenstate 2: Tracked to index 1 (Overlap: 0.999992)
  Step 30, Eigenstate 3: Tracked to index 3 (Overlap: 0.999954)
  Step 60, Eigenstate 0: Tracked to index 0 (Overlap: 1.000000)
  Step 60, Eigenstate 1: Tracked to index 2 (Overlap: 0.996083)
  Step 60, Eigenstate 2: Tracked to index 1 (Overlap: 0.996083)
  Step 60, Eigenstate 3: Tracked to index 3 (Overlap: 1.000000)
  Step 90, Eigenstate 0: Tracked to index 0 (Overlap: 0.999557)
  Step 90, Eigenstate 1: Tracked to index 2 (Overlap: 0.985652)
  Step 90, Eigenstate 2: Tracked to index 3 (Overlap: 0.986752)
  Step 90, Eigenstate 3: Tracked to index 1 (Overlap: 0.996646)
  Step 120, Eigenstate 0: Tracked to index 0 (Overlap: 1.000000)
  Step 120, Eigenstate 1: Tracked to index 2 (Overlap: 1.000000)
  Step 120, Eigenstate 2: Tracked to index 1 (Overlap: 1.000000)
  Step 120, Eigenstate 3: Tracked to index 3 (Overlap: 1.000000)
  Step 150, Eigenstate 0: Tracked to index 0 (Overlap: 1.000000)
  Step 150, Eigenstate 1: Tracked to index 2 (Overlap: 0.999999)
  Step 150, Eigenstate 2: Tracked to index 1 (Overlap: 1.000000)
  Step 150, Eigenstate 3: Tracked to index 3 (Overlap: 0.999999)
  Step 180, Eigenstate 0: Tracked to index 0 (Overlap: 0.999710)
  Step 180, Eigenstate 1: Tracked to index 2 (Overlap: 0.972606)
  Step 180, Eigenstate 2: Tracked to index 1 (Overlap: 0.992532)
  Step 180, Eigenstate 3: Tracked to index 3 (Overlap: 0.975142)
  Step 210, Eigenstate 0: Tracked to index 0 (Overlap: 1.000000)
  Step 210, Eigenstate 1: Tracked to index 3 (Overlap: 0.999983)
  Step 210, Eigenstate 2: Tracked to index 1 (Overlap: 0.999552)
  Step 210, Eigenstate 3: Tracked to index 2 (Overlap: 0.999540)
  Step 240, Eigenstate 0: Tracked to index 0 (Overlap: 1.000000)
  Step 240, Eigenstate 1: Tracked to index 3 (Overlap: 0.999960)
  Step 240, Eigenstate 2: Tracked to index 1 (Overlap: 0.999995)
  Step 240, Eigenstate 3: Tracked to index 2 (Overlap: 0.999957)
  Step 270, Eigenstate 0: Tracked to index 0 (Overlap: 1.000000)
  Step 270, Eigenstate 1: Tracked to index 2 (Overlap: 0.999806)
  Step 270, Eigenstate 2: Tracked to index 1 (Overlap: 1.000000)
  Step 270, Eigenstate 3: Tracked to index 3 (Overlap: 0.999806)
  Step 300, Eigenstate 0: Tracked to index 0 (Overlap: 1.000000)
  Step 300, Eigenstate 1: Tracked to index 2 (Overlap: 1.000000)
  Step 300, Eigenstate 2: Tracked to index 1 (Overlap: 1.000000)
  Step 300, Eigenstate 3: Tracked to index 3 (Overlap: 1.000000)
  Step 330, Eigenstate 0: Tracked to index 0 (Overlap: 1.000000)
  Step 330, Eigenstate 1: Tracked to index 2 (Overlap: 0.999991)
  Step 330, Eigenstate 2: Tracked to index 1 (Overlap: 0.999991)
  Step 330, Eigenstate 3: Tracked to index 3 (Overlap: 1.000000)
  Step 360, Eigenstate 0: Tracked to index 0 (Overlap: 1.000000)
  Step 360, Eigenstate 1: Tracked to index 2 (Overlap: 0.999777)
  Step 360, Eigenstate 2: Tracked to index 1 (Overlap: 0.999792)
  Step 360, Eigenstate 3: Tracked to index 3 (Overlap: 0.999985)
Total eigenstate reorderings: 789 (out of 1444 possible)
Eigenstate 0 first-last dot product: 0.99981891 (Full cycle: True)
Eigenstate 1 first-last dot product: 0.97630804 (Full cycle: False)
Eigenstate 2 first-last dot product: 0.97743349 (Full cycle: False)
Eigenstate 3 first-last dot product: 0.99786447 (Full cycle: True)
Warning: Overlap magnitude for eigenstate 0 at step 2 is 0.999822, not close to 1.0
Warning: Overlap magnitude for eigenstate 0 at step 12 is 0.999786, not close to 1.0
Warning: Overlap magnitude for eigenstate 0 at step 13 is 0.999781, not close to 1.0
Warning: Overlap magnitude for eigenstate 0 at step 23 is 0.999745, not close to 1.0
Warning: Overlap magnitude for eigenstate 0 at step 24 is 0.999741, not close to 1.0
Warning: Overlap magnitude for eigenstate 0 at step 34 is 0.999705, not close to 1.0
Warning: Overlap magnitude for eigenstate 0 at step 35 is 0.999701, not close to 1.0
Warning: Overlap magnitude for eigenstate 0 at step 45 is 0.999668, not close to 1.0
Warning: Overlap magnitude for eigenstate 0 at step 46 is 0.999664, not close to 1.0
Warning: Overlap magnitude for eigenstate 0 at step 56 is 0.999633, not close to 1.0
Warning: Overlap magnitude for eigenstate 0 at step 57 is 0.999630, not close to 1.0
Warning: Overlap magnitude for eigenstate 0 at step 67 is 0.999603, not close to 1.0
Warning: Overlap magnitude for eigenstate 0 at step 68 is 0.999600, not close to 1.0
Warning: Overlap magnitude for eigenstate 0 at step 78 is 0.999577, not close to 1.0
Warning: Overlap magnitude for eigenstate 0 at step 79 is 0.999575, not close to 1.0
Warning: Overlap magnitude for eigenstate 0 at step 89 is 0.999557, not close to 1.0
Warning: Overlap magnitude for eigenstate 0 at step 90 is 0.999555, not close to 1.0
Warning: Overlap magnitude for eigenstate 0 at step 100 is 0.999544, not close to 1.0
Warning: Overlap magnitude for eigenstate 0 at step 101 is 0.999543, not close to 1.0
Warning: Overlap magnitude for eigenstate 0 at step 111 is 0.999530, not close to 1.0
Too many warnings, suppressing further overlap warnings...
Eigenstate 0 had 42/360 problematic overlaps
Eigenstate 0 had 0 parity flips during the cycle
Eigenstate 1 had 171/360 problematic overlaps
Eigenstate 1 had 186 parity flips during the cycle
Eigenstate 2 had 115/360 problematic overlaps
Eigenstate 2 had 66 parity flips during the cycle
Eigenstate 3 had 145/360 problematic overlaps
Eigenstate 3 had 112 parity flips during the cycle

Berry Phase Analysis:
------------------------------------------------------------------------------------------------------------------------
Eigenstate Raw Phase (rad) Winding Number  Mod 2Ï€ Phase    Normalized      Quantized       Error      Full Cycle     
------------------------------------------------------------------------------------------------------------------------
0          0.000000        0               0.000000        0.000000        0.000000        0.000000   True           
1          0.000000        0               0.000000        0.000000        0.000000        0.000000   True           
2          0.000000        0               3.141593        -3.141593       -3.141593       0.000000   True           
3          0.000000        0               0.000000        0.000000        0.000000        0.000000   True           
Saved eigenvalue evolution plot to improved_berry_phase_plots/eigenvalue_evolution.png
Saved phase contributions plot to improved_berry_phase_plots/phase_contributions.png
Saved cumulative phase plot to improved_berry_phase_plots/cumulative_phase.png
Saved parity flips plot to improved_berry_phase_plots/parity_flips.png
Saved overlap magnitudes plot to improved_berry_phase_plots/overlap_magnitudes.png
Saved eigenstate tracking plot to improved_berry_phase_plots/eigenstate_tracking.png
All visualizations created and saved to improved_berry_phase_plots
Results saved to improved_berry_phase_results/improved_berry_phase_summary.txt

Improved Berry phase calculation complete!
Results saved to improved_berry_phase_results
Plots saved to improved_berry_phase_plots
