Loaded 361 eigenvector files. Shape: (361, 4, 4)
Loaded 361 eigenvalue files. Shape: (361, 4)

Tracking eigenstates by maximum overlap...
  Step 30, Eigenstate 0: Tracked to index 0 (Overlap: 1.000000)
  Step 30, Eigenstate 1: Tracked to index 3 (Overlap: 1.000000)
  Step 30, Eigenstate 2: Tracked to index 1 (Overlap: 0.999999)
  Step 30, Eigenstate 3: Tracked to index 2 (Overlap: 0.999999)
  Step 60, Eigenstate 0: Tracked to index 0 (Overlap: 1.000000)
  Step 60, Eigenstate 1: Tracked to index 3 (Overlap: 1.000000)
  Step 60, Eigenstate 2: Tracked to index 1 (Overlap: 0.999934)
  Step 60, Eigenstate 3: Tracked to index 2 (Overlap: 0.999934)
  Step 90, Eigenstate 0: Tracked to index 0 (Overlap: 0.999985)
  Step 90, Eigenstate 1: Tracked to index 1 (Overlap: 0.999968)
  Step 90, Eigenstate 2: Tracked to index 3 (Overlap: 0.999687)
  Step 90, Eigenstate 3: Tracked to index 2 (Overlap: 0.999684)
  Step 120, Eigenstate 0: Tracked to index 0 (Overlap: 1.000000)
  Step 120, Eigenstate 1: Tracked to index 3 (Overlap: 1.000000)
  Step 120, Eigenstate 2: Tracked to index 1 (Overlap: 1.000000)
  Step 120, Eigenstate 3: Tracked to index 2 (Overlap: 1.000000)
  Step 150, Eigenstate 0: Tracked to index 0 (Overlap: 1.000000)
  Step 150, Eigenstate 1: Tracked to index 3 (Overlap: 1.000000)
  Step 150, Eigenstate 2: Tracked to index 1 (Overlap: 1.000000)
  Step 150, Eigenstate 3: Tracked to index 2 (Overlap: 1.000000)
  Step 180, Eigenstate 0: Tracked to index 0 (Overlap: 0.999994)
  Step 180, Eigenstate 1: Tracked to index 3 (Overlap: 0.999824)
  Step 180, Eigenstate 2: Tracked to index 1 (Overlap: 0.999836)
  Step 180, Eigenstate 3: Tracked to index 2 (Overlap: 0.999721)
  Step 210, Eigenstate 0: Tracked to index 0 (Overlap: 1.000000)
  Step 210, Eigenstate 1: Tracked to index 2 (Overlap: 0.999993)
  Step 210, Eigenstate 2: Tracked to index 1 (Overlap: 0.999993)
  Step 210, Eigenstate 3: Tracked to index 3 (Overlap: 1.000000)
  Step 240, Eigenstate 0: Tracked to index 0 (Overlap: 1.000000)
  Step 240, Eigenstate 1: Tracked to index 2 (Overlap: 1.000000)
  Step 240, Eigenstate 2: Tracked to index 1 (Overlap: 1.000000)
  Step 240, Eigenstate 3: Tracked to index 3 (Overlap: 1.000000)
  Step 270, Eigenstate 0: Tracked to index 0 (Overlap: 1.000000)
  Step 270, Eigenstate 1: Tracked to index 2 (Overlap: 0.999959)
  Step 270, Eigenstate 2: Tracked to index 1 (Overlap: 1.000000)
  Step 270, Eigenstate 3: Tracked to index 3 (Overlap: 0.999959)
  Step 300, Eigenstate 0: Tracked to index 0 (Overlap: 1.000000)
  Step 300, Eigenstate 1: Tracked to index 2 (Overlap: 1.000000)
  Step 300, Eigenstate 2: Tracked to index 1 (Overlap: 1.000000)
  Step 300, Eigenstate 3: Tracked to index 3 (Overlap: 1.000000)
  Step 330, Eigenstate 0: Tracked to index 0 (Overlap: 1.000000)
  Step 330, Eigenstate 1: Tracked to index 2 (Overlap: 1.000000)
  Step 330, Eigenstate 2: Tracked to index 1 (Overlap: 1.000000)
  Step 330, Eigenstate 3: Tracked to index 3 (Overlap: 1.000000)
  Step 360, Eigenstate 0: Tracked to index 0 (Overlap: 1.000000)
  Step 360, Eigenstate 1: Tracked to index 1 (Overlap: 0.999997)
  Step 360, Eigenstate 2: Tracked to index 2 (Overlap: 0.999988)
  Step 360, Eigenstate 3: Tracked to index 3 (Overlap: 0.999991)
Total eigenstate reorderings: 863 (out of 1444 possible)
Eigenstate 0 first-last dot product: 0.99999375 (Full cycle: True)
Eigenstate 1 first-last dot product: 0.01924076 (Full cycle: False)
Eigenstate 2 first-last dot product: 0.01934548 (Full cycle: False)
Eigenstate 3 first-last dot product: 0.99976489 (Full cycle: True)
Eigenstate 0 had 0/360 problematic overlaps
Eigenstate 0 had 0 parity flips during the cycle
Warning: Overlap magnitude for eigenstate 1 at step 2 is 0.999453, not close to 1.0
Warning: Overlap magnitude for eigenstate 1 at step 4 is 0.999578, not close to 1.0
Warning: Overlap magnitude for eigenstate 1 at step 5 is 0.988837, not close to 1.0
Warning: Overlap magnitude for eigenstate 1 at step 6 is 0.922984, not close to 1.0
Warning: Overlap magnitude for eigenstate 1 at step 7 is 0.994055, not close to 1.0
Warning: Overlap magnitude for eigenstate 1 at step 8 is 0.999680, not close to 1.0
Warning: Overlap magnitude for eigenstate 1 at step 12 is 0.999736, not close to 1.0
Warning: Overlap magnitude for eigenstate 1 at step 13 is 0.999793, not close to 1.0
Warning: Overlap magnitude for eigenstate 1 at step 178 is 0.999850, not close to 1.0
Warning: Overlap magnitude for eigenstate 1 at step 179 is 0.999824, not close to 1.0
Warning: Overlap magnitude for eigenstate 1 at step 186 is 0.999648, not close to 1.0
Warning: Overlap magnitude for eigenstate 1 at step 187 is 0.995434, not close to 1.0
Warning: Overlap magnitude for eigenstate 1 at step 188 is 0.860936, not close to 1.0
Warning: Overlap magnitude for eigenstate 1 at step 189 is 0.934820, not close to 1.0
Warning: Overlap magnitude for eigenstate 1 at step 190 is 0.995469, not close to 1.0
Warning: Overlap magnitude for eigenstate 1 at step 191 is 0.999116, not close to 1.0
Warning: Overlap magnitude for eigenstate 1 at step 192 is 0.999861, not close to 1.0
Warning: Overlap magnitude for eigenstate 1 at step 200 is 0.999120, not close to 1.0
Warning: Overlap magnitude for eigenstate 1 at step 201 is 0.998142, not close to 1.0
Warning: Overlap magnitude for eigenstate 1 at step 202 is 0.998290, not close to 1.0
Too many warnings, suppressing further overlap warnings...
Eigenstate 1 had 54/360 problematic overlaps
Eigenstate 1 had 187 parity flips during the cycle
Eigenstate 2 had 56/360 problematic overlaps
Eigenstate 2 had 67 parity flips during the cycle
Eigenstate 3 had 78/360 problematic overlaps
Eigenstate 3 had 111 parity flips during the cycle

Berry Phase Analysis:
------------------------------------------------------------------------------------------------------------------------
Eigenstate Raw Phase (rad) Winding Number  Mod 2Ï€ Phase    Normalized      Quantized       Error      Full Cycle     
------------------------------------------------------------------------------------------------------------------------
0          0.000000        0               0.000000        0.000000        0.000000        0.000000   True           
1          0.000000        0               0.000000        0.000000        0.000000        0.000000   True           
2          0.000000        0               3.141593        -3.141593       -3.141593       0.000000   True           
3          0.000000        0               0.000000        0.000000        0.000000        0.000000   True           
Saved eigenvalue evolution plot to improved_berry_phase_plots_x5.0_y1.5_d0.042_w0.00025_avx0.018_ava0.42/eigenvalue_evolution.png
Saved phase contributions plot to improved_berry_phase_plots_x5.0_y1.5_d0.042_w0.00025_avx0.018_ava0.42/phase_contributions.png
Saved cumulative phase plot to improved_berry_phase_plots_x5.0_y1.5_d0.042_w0.00025_avx0.018_ava0.42/cumulative_phase.png
Saved parity flips plot to improved_berry_phase_plots_x5.0_y1.5_d0.042_w0.00025_avx0.018_ava0.42/parity_flips.png
Saved overlap magnitudes plot to improved_berry_phase_plots_x5.0_y1.5_d0.042_w0.00025_avx0.018_ava0.42/overlap_magnitudes.png
Saved eigenstate tracking plot to improved_berry_phase_plots_x5.0_y1.5_d0.042_w0.00025_avx0.018_ava0.42/eigenstate_tracking.png
All visualizations created and saved to improved_berry_phase_plots_x5.0_y1.5_d0.042_w0.00025_avx0.018_ava0.42
Results saved to improved_berry_phase_results/improved_berry_phase_summary.txt

Improved Berry phase calculation complete!
Results saved to improved_berry_phase_results
Plots saved to improved_berry_phase_plots
